<?php 	class Product_category_manage extends CI_Model {		public function __construct()		{			//parent::__construct();		}					public function add_productcategory_manage($params=array())		{			try {				$category_name=$params['category_name'];				$category_status=$params['category_status'];				$data = array(						'category_name' => $category_name,					'category_status' => $category_status,						);				$sql = "INSERT INTO `ve_product_category`(`category_name`, `category_status`) VALUES ('".$this->db->escape_str($category_name)."','".$category_status."')";				//echo $sql;exit;				$this->db->query($sql);				$lastid= $this->db->insert_id();								$result['data'] =  $lastid;				$result['success'] = true;				$result['error'] = '';			}			catch(Exception $e)			{				$result['success'] = false;				$result['error'] = $e->getMessage();			}			return $result;		}		public function edit_productcategory_manage($params=array())		{					//print_r($params); exit;			try {				$product_category_id = $params['product_category_id'];				$sql = "UPDATE `ve_product_category` SET category_name = :category_name, category_status = :category_status WHERE product_category_id = :product_category_id";				$stmt2 = $this->db->conn_id->prepare($sql);									$stmt2->bindParam("category_name", $params['formdata']['cat_name']);				$stmt2->bindParam("category_status", $params['formdata']['cat_status']);				$stmt2->bindParam("product_category_id",$product_category_id);					if($stmt2->execute()){						$result['success'] = true;						$result['message'] = "Product category successfully Updated";						$result['error'] = '';					}else {						$result['success'] = false;						$result['message'] = "Sorry please try again";					}				}				catch(Exception $e)				{					$result['success'] = false;					$result['error'] = $e->getMessage();				}			return $result;		}		public function formfilelist($params=array()){			if(isset($params['groupuser']) && $params['groupuser']=='editform'){				$sql = "SELECT * FROM `ve_product_category` WHERE 1 ";			}			else{				$sql = "SELECT * FROM `ve_product_category` WHERE 1 ";			}			try {				$product_category_id=(isset($params['product_category_id'])) ? $params['product_category_id'] : '';				if(isset($product_category_id) && $product_category_id!='')				{					$sql.=" AND `product_category_id`='".$product_category_id."'";				}				if(isset($params['search_term']) && $params['search_term'] != ''){					$sql.=" AND `category_name` LIKE '%".$params['search_term']."%' ";				}				$offset=(isset($params['offset'])) ? $params['offset'] : '';				$limit=(isset($params['limit'])) ? $params['limit'] : '';				if(isset($offset) && $offset != '')				{					$sql.=" limit $offset ";				}				if(isset($limit) && $limit != '')				{					$sql.=" , $limit";				}				$sql .= " ORDER BY product_category_id DESC";				//echo $sql;					$query = $this->db->query($sql);				//print_r($query );exit;				$total_count=(isset($params['total_count'])) ? $params['total_count'] : '';				if(isset($total_count) && $total_count=='yes')				{					$datalist = $query->num_rows();				}				else{					$datalist = $query->result_array();				}				$result['success'] = true;				$result['data'] =  $datalist;				$result['error'] = '';			}			catch(Exception $e)			{				$result['success'] = false;				$result['error'] = $e->getMessage();			}			return $result;		}		public function delete_productcategory($params=array()){						try{				$product_category_id = (isset($params['product_category_id']) && $params['product_category_id']!='') ? $params['product_category_id'] :'';				if(isset($product_category_id) && $product_category_id!='')				{									$this->db->where('product_category_id',$product_category_id);					$this->db->delete('ve_product_category');								$this->db->set('product_category_id',0);					$this->db->where('product_category_id',$product_category_id);										$this->db->update('ve_product_master');					$this->db->set('product_category_id',0);					$this->db->where('product_category_id',$product_category_id);										$this->db->update('ve_product_sub_category');					$this->db->set('category_id',0);					$this->db->where('category_id',$product_category_id);										$this->db->update('ve_external_user_products');				}								$result['success'] = true;				$result['error'] = '';			}			catch(Exception $e){				$result['success'] = false;				$result['error'] = $e->getMessage();			}			return $result;		}	}	